<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Desafio Pokemones</title>
    <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.no-icons.min.css"
        rel="stylesheet">
    <link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="styles.css">

<style>
#cbPokemon {
  height:30px;
  width:200px;
  margin-left: 5px;
}

.buscar .menu {
    padding-left: 10px;
}


</style>

</head>

<body>
    <div class="container-fluid titulo">
        <div class="row">
            <div class="col-sm-12">
                <h3>POKEMONES</h3> - <h4> Arceus Group</h4>
            </div>
        </div>
    </div>

    <div class="container-fluid centrado" id="selectores">
        <div class="row">
            <div class="col-sm-4 col-xs-12 col-md-4 col-lg-4">
                <div class="input-group input-group-sm mb-3">
                    <input type="text" name="txtBuscar" id="txtBuscar" class="form-control"
                        aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm"
                        placeholder="Numero / Nombre"><a href="javascript:buscar();"><i
                            class="icon-search icon-2x buscar"></i></a>
                </div>
            </div>
        </div>
    </div>

    <div class="container menu">
        <div class="row">
            <div class="col-lg-12">
                <a href="javascript:inicio();"><i class="icon-home icon-2x"></i> Home </a>
                <span id="selectPokemon"></span>
            </div>
        </div>
    </div>


<!--
    <div id="carouselExampleInterval" class="carousel slide" data-ride="carousel">
        <div class="carousel-inner">
            <div class="carousel-item active" data-interval="3000">
                <img src="https://pokeres.bastionbot.org/images/pokemon/1.png" class="d-block w-100" alt="...">
                <p id="titulo-slide">Bulbasaur</p>
            </div>
            <div class="carousel-item" data-interval="3000">
                <img src="https://pokeres.bastionbot.org/images/pokemon/2.png" class="d-block w-100" alt="...">
                <p id="titulo-slide">Ivysaur</p>
            </div>
            <div class="carousel-item" data-interval="3000">
                <img src="https://pokeres.bastionbot.org/images/pokemon/3.png" class="d-block w-100" alt="...">
                <p id="titulo-slide">Venusaur</p>
            </div>
        </div>
        <a class="carousel-control-prev" href="#carouselExampleInterval" role="button" data-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleInterval" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
    </div>
-->
<br>    
    <div class="container-fluid gifAnimado">
        <div class="row">
            <div class="col-xs-12 col-sm-6">
                <p><img src="https://i.kym-cdn.com/photos/images/original/000/925/484/270.gif"></p>
            </div>
        </div>
    </div>

    <div class="container-fluid unPokemon">
        <div class="row center">
            <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4">
                <div id="unPokemon">
                </div>
            </div>
        </div>
    </div>

<!--
    <div class="container-fluid centrado" id="selectores">
        <div class="row">
            <div class="col-sm-12">
                <span id="pokemon"></span>
                <span id="genero"></span>
                <span id="colores"></span>
                <span id="habitat"></span>
                <span id="formas"></span>
                <span id="especies"></span>
                <span id="tipos"></span>
                <span id="estilosDeBatallas"></span>
                <span id="containerDiv">...</span>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="row center">
            <div class="col-xs-12 col-sm-12  col-md-12 col-lg-4">
                <div id="poke-container">
                </div>
            </div>
        </div>
    </div>

-->
    <div class="container">
        <div id="poke-container" class="ui cards">
        </div>
    </div>


<!-- Footer -->
<div id="footer-zone"> 
    POKEMONES - Arceus Group
</div> 
  <!-- Footer -->


    <script src="https://code.jquery.com/jquery-3.2.1.js"
        integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
        crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
    <script>
        $(document).ready(function () {
            llenaCbPokemon();
            $(".gifAnimado").show();
            //$('.carousel').carousel();
            $(".buscar").click(function () {
                var nombre = $("#txtBuscar").val();
                nombre = nombre.toLowerCase();
                //alert("buscar ajax");

                $.ajax({
                    url: `https://pokeapi.co/api/v2/pokemon/${nombre}`,
                    type: "get",
                    dataType: 'json',
                })
                    .done(function (result) {
                        var pokeID = result.id;
                        var nombre = result.name;
                        var imagen = `https://pokeres.bastionbot.org/images/pokemon/${pokeID}.png`;
                        var types = result.types;
                        var altura = result.height;
                        var peso = result.weight;
                        var genero = result.genre;
                        var color = result.color;
                        var stats = result.stats;
                        var statsLabel = [];
                        var statsValues = [];
                        var specie = result.species.name;

                        var listaTipos = "<ul>";
                        types.forEach(function (type) {
                            listaTipos += "<li>" + type['type']['name'] + "</li>";
                        });
                        listaTipos += "</lu>";

                        for (i = 0; i < stats.length; i++) {
                            statsLabel[i] = stats[i].stat.name;
                            statsValues[i] = stats[i].base_stat;
                        }



                        var tarjeta = '<div class="card">';
                        tarjeta += `<img src="${imagen}" class="card-img-top" alt="..." style="padding:20px;">
                        <div class="card-body">
                            <h5 class="card-title">Nro: ${pokeID}</h5>
                            <hr>
                            <h5 class="card-title">${nombre}</h5>
                            <p class="card-text">This is a wider card with supporting text below as a natural lead-in to additional
                                content. This content is a little bit longer.</p>
                                <hr>    
                                <table border="1" style="padding:5px;" width="30%">
                                  <tr align="center" style=""><td>Tipos</td></tr>
                                  <tr align="center"><td>${listaTipos}</td></tr>
                                </table>
                                <table border="1" style="padding:5px;" width="80%">
                                <hr>
                                  <tr align="center" style=""><td>Altura</td><td>Peso</td><td>Especie</td></tr>
                                  <tr align="center"><td>${altura}</td><td>${peso}</td><td>${specie}</td></tr>
                                </table>
                                <hr>
                                <canvas id="myChart" width="400" height="200"></canvas>

                        </div></div>`;

                        $("#unPokemon").html(tarjeta);
                        var ctx = document.getElementById('myChart').getContext('2d');
                        var chart = new Chart(ctx, {
                            // The type of chart we want to create
                            type: 'horizontalBar',

                            // The data for our dataset

                            //https://www.pokexperto.net/index2.php?seccion=nds/nationaldex/stats&pk=3
                            data: {
                                //labels: ['January', 'February', 'March', 'April', 'May', 'June', 'July'],
                                labels: statsLabel,
                                datasets: [{
                                    label: '',
                                    backgroundColor: 'rgb(255, 99, 132)',
                                    borderColor: 'rgb(255, 99, 132)',
                                    data: statsValues
                                }]
                            },

                            // Configuration options go here
                            options: {}
                        });
                        
                        $('.carousel').hide();
                        $(".gifAnimado").hide();
                        $("#poke-container").hide();
                        $("#unPokemon").show();
                        alet("show");
                    });

            });

        });
    </script>

    <script>

        function fetchUnPokemon(pokeID) {

            var tarjeta = "";
            for (pokeID = 1; pokeID < 4; pokeID++) {
                //var pokeID = 1;
                $.ajax({
                    url: `https://pokeapi.co/api/v2/pokemon/${pokeID}`, success: function (result) {
  
                        var pokeID = result.id;
                        var imagen = "";
                        var nombre = result.name;
                        console.log(result);
                        var imagen = `https://pokeres.bastionbot.org/images/pokemon/${pokeID}.png`;
                        var types = result.types;


                        var listaTipos = "<ul>";
                        types.forEach(function (type) {
                            listaTipos += "<li>" + type['type']['name'] + "</li>";
                            //alert(type['type']['name']);
                        });
                        listaTipos += "</lu>";
                        tarjeta += '<div class="card">';
                        tarjeta += `<img src="${imagen}" class="card-img-top" alt="...">
            <div class="card-body">
                <h5 class="card-title">${nombre}</h5>
                <p class="card-text">This is a wider card with supporting text below as a natural lead-in to additional
                    content. This content is a little bit longer.</p>
                <p class="card-text">${listaTipos}</small></p>
            </div></div>`;


                    }
                });

            }
            $("#poke-container").html(tarjeta);
        }




        function fetchKantoPokemon() {
            fetch('https://pokeapi.co/api/v2/pokemon?limit=10')
                .then(response => response.json())
                .then(function (allpokemon) {
                    allpokemon.results.forEach(function (pokemon) {
                        fetchPokemonData(pokemon);
                    })
                })
        }

        function fetchPokemonData(pokemon) {
            let url = pokemon.url // <--- this is saving the pokemon url to a variable to use in the fetch. 
            //Example: https://pokeapi.co/api/v2/pokemon/1/"
            fetch(url)
                .then(response => response.json())
                .then(function (pokeData) {
                    renderPokemon(pokeData)
                })
        }


        function renderPokemon(pokeData) {
            let allPokemonContainer = document.getElementById('poke-container');
            let pokeContainer = document.createElement("div") //div will be used to hold the data/details for indiviual pokemon.{}
            pokeContainer.classList.add('ui', 'card');

            createPokeImage(pokeData.id, pokeContainer);

            let pokeName = document.createElement('h4')
            pokeName.innerText = pokeData.name

            let pokeNumber = document.createElement('p')
            pokeNumber.innerText = `#${pokeData.id}`

            let pokeTypes = document.createElement('ul') //ul list will hold the pokemon types


            createTypes(pokeData.types, pokeTypes) // helper function to go through the types array and create li tags for each one

            pokeContainer.append(pokeName, pokeNumber, pokeTypes);   //appending all details to the pokeContainer div
            allPokemonContainer.appendChild(pokeContainer);       //appending that pokeContainer div to the main div which will                                                             hold all the pokemon cards
        }


        function createPokeImage(pokeID, containerDiv) {
            let pokeImgContainer = document.createElement('div')
            pokeImgContainer.classList.add('image')

            let pokeImage = document.createElement('img')
            pokeImage.srcset = `https://pokeres.bastionbot.org/images/pokemon/${pokeID}.png`

            pokeImgContainer.append(pokeImage);
            containerDiv.append(pokeImgContainer);
        }

        function createTypes(types, ul) {
            types.forEach(function (type) {
                let typeLi = document.createElement('li');
                typeLi.innerText = type['type']['name'];
                ul.append(typeLi)
            })
        }


        function renderAbility(pokeID, containerDiv) {


        }


        function renderTypos(pokeID, containerDiv) {


        }

        function inicio() {
            $(".gifAnimado").show();
            $('.carousel').hide();
            $('.unPokemon').hide();
            //fetchKantoPokemon();
        }



        function getSelectPokemon(sel) {
            var nombre = sel.value;
            $.ajax({
                    url: `https://pokeapi.co/api/v2/pokemon/${nombre}`,
                    type: "get",
                    dataType: 'json',
            })
            .done(function (result) {
                var pokeID = result.id;
                var nombre = result.name;
                var imagen = `https://pokeres.bastionbot.org/images/pokemon/${pokeID}.png`;
                var types = result.types;
                var altura = result.height;
                var peso = result.weight;
                var genero = result.genre;
                var color = result.color;
                var stats = result.stats;
                var statsLabel = [];
                var statsValues = [];
                var specie = result.species.name;

                var listaTipos = "<ul>";
                types.forEach(function (type) {
                    listaTipos += "<li>" + type['type']['name'] + "</li>";
                });
                listaTipos += "</lu>";

                for (i = 0; i < stats.length; i++) {
                    statsLabel[i] = stats[i].stat.name;
                    statsValues[i] = stats[i].base_stat;
                }



                var tarjeta = '<div class="card">';
                tarjeta += `<img src="${imagen}" class="card-img-top" alt="..." style="padding:20px;">
                <div class="card-body">
                    <h5 class="card-title">Nro: ${pokeID}</h5>
                    <hr>
                    <h5 class="card-title">${nombre}</h5>
                    <p class="card-text">This is a wider card with supporting text below as a natural lead-in to additional
                        content. This content is a little bit longer.</p>
                        <hr>    
                        <table border="1" style="padding:5px;" width="30%">
                            <tr align="center" style=""><td>Tipos</td></tr>
                            <tr align="center"><td>${listaTipos}</td></tr>
                        </table>
                        <table border="1" style="padding:5px;" width="80%">
                        <hr>
                            <tr align="center" style=""><td>Altura</td><td>Peso</td><td>Especie</td></tr>
                            <tr align="center"><td>${altura}</td><td>${peso}</td><td>${specie}</td></tr>
                        </table>
                        <hr>
                        <canvas id="myChart" width="400" height="200"></canvas>

                </div></div>`;

                $("#unPokemon").html(tarjeta);
                var ctx = document.getElementById('myChart').getContext('2d');
                var chart = new Chart(ctx, {
                    // The type of chart we want to create
                    type: 'horizontalBar',

                    // The data for our dataset

                    //https://www.pokexperto.net/index2.php?seccion=nds/nationaldex/stats&pk=3
                    data: {
                        labels: ['January', 'February', 'March', 'April', 'May', 'June', 'July'],
                        labels: statsLabel,
                        datasets: [{
                            label: '',
                            backgroundColor: 'rgb(255, 99, 132)',
                            borderColor: 'rgb(255, 99, 132)',
                            data: statsValues
                        }]
                    },

                    // Configuration options go here
                    options: {}
                });
                $('.unPokemon').show();
                $('.carousel').hide();
                $(".gifAnimado").hide();
                $("#poke-container").hide();
            });

        }


        function llenaCbPokemon(){

            $.ajax({
                url: "https://pokeapi.co/api/v2/pokemon", success: function (result) {
                var count = result.count
                var resultados = result.results
                var combo = `<select name='cbPokemon' id='cbPokemon' onChange="getSelectPokemon(this)">`;
                combo += "<option value='0'>Pokemon</option>";

                var imagen = "";
                resultados.forEach(element => {
                    combo += "<option value='" + element.name + "'>" + element.name + "</option>";
                    //alert( element.name);    

                });
                combo += "</option>";
                $("#selectPokemon").html(combo);
                $("#selectPokemon").show();
                
                }
            });
        }


        function buscar(){
            //alert("buscar");
            $('.unPokemon').show();
        }
    </script>

</body>

</html>